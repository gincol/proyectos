<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="es.bcn.imi.framework.vigia.frontal.gap.inventary.orm.dao.PhysicalModelGapDao">
   
     <select id="getPhysicalModelsGap" resultType="es.bcn.vigia.fmw.libcommons.integration.orm.model.gap.PhysicalModelGap">
        SELECT 
			CODI AS code, 
			CONTRACTISTA AS contractCode,
			ESTAT_CODI AS statusCode,
	      	ESTAT_DESCRIPCIO AS statusDescription,
	      	TIPUS_CODI AS typeCode,
	      	TIPUS_DESCRIPCIO AS typeDescription,
	      	FRACCIO_CODI AS fractionTypeCode,
	      	FRACCIO_DESCRIPCIO AS fractionTypeDescription,
	      	MARCA_CODI AS brandCode,
			MARCA_DESCRIPCIO AS brandDescription 
		FROM 
			VW_MOBILIARI_FISIC
		WHERE
			DATA_INICI <![CDATA[<=]]> SYSDATE AND (DATA_FI  <![CDATA[>=]]> SYSDATE OR DATA_FI IS NULL)
		<if test="codeMCL != null">
        	AND
        		MCL = #{codeMCL}
        </if>
        <if test="codeMCF != null">	     
			AND
            	CODI = #{codeMCF}
        </if>
        <if test="codeUbication != null">	     
			AND
            	UBICACIO = #{codeUbication}
        </if> 
        <if test="listCodesMCF != null">
        	AND CODI IN
			<foreach collection="listCodesMCF" item="codeMCF"
				index="index" open="(" separator="," close=")">
				#{codeMCF}
			</foreach>
		</if>	
    </select>
    
        
</mapper>
